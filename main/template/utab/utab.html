{% extends "ltab/default.html" %}

{% block utab %}
<style>
/* CSS 스타일링 */
.tab-menu {
    display: flex; /* 탭들을 가로로 배열하기 위해 Flexbox 사용 */
    align-items: center; /* 세로 중앙 정렬 */
    position: sticky;
    top: 0;
    background-color: #fff;
    padding: 0;
    z-index: 1000;
}
/* 폰트 */
.tablinks {
    font-family: 'Roboto', sans-serif;
}

.tab-menu button {
    background-color: inherit;
    float: left;
    border: none;
    outline: none;
    cursor: pointer;
    padding: 10px 16px;
    transition: 0.3s;
}

.tab-menu button:hover {
    background-color: #ddd;
}

.tab-menu button.active {
    background-color: #fff;
    border-bottom: 2px solid #000;
}

/* 오른쪽 정렬 스타일 */
.share-button {
    position: fixed; /* 페이지 스크롤에 따라 고정되도록 설정 */
    top: 0;
    right: 0; /* 페이지의 오른쪽에 고정 */
    background-color: inherit;
    border: none;
    outline: none;
    cursor: pointer;
    padding: 14px 16px;
    transition: 0.3s;
}

.share-button:hover {
    background-color: #ddd;
}

.share-box {
    position: fixed; /* 페이지 스크롤에 따라 고정되도록 설정 */
    top: 7.9%; /* 화면 상단에서 절반 높이로 설정 */
    left: 86.7%; /* 화면 왼쪽에서 절반 너비로 설정 */
    transform: translate(-50%, -50%); /* 상자를 정확한 중앙으로 이동 */
    min-width: 200px;
    background-color: #fff;
    border: 1px solid #ccc;
    border-radius: 5px;
    box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
    z-index: 1;
    opacity: 0; /* 초기에는 투명하게 설정 */
    transition: opacity 0.3s ease-in-out; /* 부드러운 나타나기/사라지기 효과를 추가합니다. */
    padding: 10px;
    pointer-events: none; /* 클릭 이벤트를 비활성화합니다. */
    display: flex; /* Flexbox 사용하여 내부 요소를 가로로 배열합니다. */
    justify-content: space-between; /* 내부 요소 사이의 여백을 최대한 확보하고 요소를 동일한 간격으로 배치합니다. */
    align-items: center; /* 수직 가운데 정렬합니다. */
}

#shareContent {
    overflow: hidden;
    text-overflow: ellipsis;
    white-space: nowrap;
    flex: 1; /* URL 텍스트가 가능한 넓은 공간을 차지할 수 있도록 설정합니다. */
    font-size: 12px; /* URL 텍스트의 글자 크기를 줄입니다 */
}

/* 카피 버튼 스타일 */
.copy-button {
    background-color: #bbb;
    border: none;
    outline: none;
    cursor: pointer;
    padding: 8px 10px;
    font-size: 14px;
}

/* 공유 박스가 나타날 때 */
.share-box.show {
    opacity: 1; /* 투명도를 1로 설정하여 나타나게 합니다. */
    pointer-events: auto; /* 클릭 이벤트를 활성화합니다. */
}

/* 박스 내부의 글자가 일정 길이를 초과할 때 말줄임표 표시 */
.share-box p {
    overflow: hidden;
    text-overflow: ellipsis;
    white-space: nowrap;
}

.url-text::placeholder {
    color: #cccbcf;
    font-size: 14px;
    font-family: ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol";
    font-weight: normal;
}
#copyButton {
    display: inline-block;
    margin-top: 8px;
    margin-left: auto;
}

#copyButton img {
    width: 50px; /* 이미지의 너비 조정 */
    height: auto; /* 이미지의 높이를 자동으로 설정 */
}


</style>

<div class="tab-menu">
  <button class="tablinks" onclick="openTab('tab1')">아자아자 3조!</button>
  <button class="tablinks" onclick="openTab('tab2')">KG프로젝트</button>
  <button class="tablinks" onclick="openTab('tab3')">요구사항 분석</button>
  <!-- 공유 탭 -->
  <button id="shareButton" class="tablinks share-button">공유</button>
  <!-- 박스 -->
  <div id="shareBox" class="share-box" style="font-family: 'Roboto', sans-serif;">
    <div id="urlBox" style="border: 1px solid black; padding: 8px; border-radius: 5px;">
        <span id="shareContent"></span>
    </div>
    <!-- 카피 버튼 이미지 -->
    <a href="#" id="copyButton">
        <img src="/static/copy.png" alt="카피 버튼">
    </a>
</div>
</div>
</div>

<script>
    var shareButton = document.getElementById("shareButton");
    shareButton.addEventListener("click", toggleShareBox); // 공유 버튼 클릭 시 토글 함수 호출

    // 카피 버튼 클릭 시 URL 복사
    var copyButton = document.getElementById("copyButton");
    copyButton.addEventListener("click", copyURL);

    function toggleShareBox() {
        var shareBox = document.getElementById("shareBox");
        shareBox.classList.toggle("show"); // 'show' 클래스를 토글하여 나타내거나 숨깁니다.
        updateShareContent(); // 공유 상자가 열릴 때마다 내용 업데이트
    }
    
    function copyURL() {
        var url = window.location.href; // 현재 페이지 URL을 가져옵니다.
        navigator.clipboard.writeText(url); // 클립보드에 URL을 복사합니다.
    }

    function updateShareContent() {
        var shareContent = document.getElementById("shareContent");
        var url = window.location.href; // 현재 페이지 URL을 가져옵니다.
        shareContent.textContent = url; // 공유 상자 내용을 현재 페이지 URL로 설정합니다.
    }

    function openTab(tabId) {
        document.location.href = "/utab/" + tabId + "/";
    }

    // 페이지 로드시 텍스트 자르기 함수 호출
    window.onload = function() {
        truncateText();
    };

    // 박스 내의 텍스트를 제한 길이로 자르고 말줄임표를 추가하는 함수
    function truncateText() {
        var shareContent = document.getElementById("shareContent");
        var maxLength = 35; // 최대 길이 설정
        var content = shareContent.textContent; // 현재 텍스트 가져오기
        if (content.length > maxLength) {
            content = content.substring(0, maxLength) + '...'; // 길이 초과 시 자르고 말줄임표 추가
        }
        shareContent.textContent = content; // 변경된 내용으로 설정
    }
</script>
{% endblock utab %}
